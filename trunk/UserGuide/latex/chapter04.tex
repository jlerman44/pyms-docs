% chapter04.tex

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                           %
 %    PyMS documentation                                                   %
 %    Copyright (C) 2005-8 Vladimir Likic                                    %
 %                                                                           %
 %    The files in this directory provided under the Creative Commons        %
 %    Attribution-NonCommercial-NoDerivs 2.1 Australia license               %
 %    http://creativecommons.org/licenses/by-nc-nd/2.1/au/                   %
 %    See the file license.txt                                               %
 %                                                                           %
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{PyMS Installation}

The instructions below refer to installation under Linux, and assume
a reasonably savvy Linux user.  Python is however fully cross-platform
compatible, and PyMS should work equally well under other operating
systems as long as the dependencies can be satisfied.

\section{Installing core dependencies}

\subsection{Preparing the environment for a local installation}

There are two methods of installing PyMS dependencies. The first is
{\it system-wide}, when root access is available. The second is {\it locally},
when write access to the system directories is unavailable, or when PyMS is
only used by one user. In this case, the dependencies are installed into a
user's home directory.

Before performing a local installation, the following extra two steps are
required.

\begin{description}
  \item [Directory structure:] \
        Create a directory for the dependencies to install into. For this
        guide, we choose \~{}/pyms-deps.
  \item [Environment variables:] \
        The \$PATH variable needs to be configured for the target installation
        directory. In the case of the bash shell, add
        {\tt PATH=\$HOME/pyms-deps/bin:\$PATH} to your .bash\_profile file,
        then reopen the terminal.
\end{description}

\subsection{Python}

Python is a general purpose object oriented programming language, which
PyMS is written in.  Python is open source and freely available
from \url{http://www.python.org/download}.

The instructions below refer to the installation of Python version
2.5.

\begin{description}
\item [Filename:] {\tt Python-2.5.tgz}
\item [Installation:] $ $
  \begin{enumerate}
  \item {\tt tar -zxvf Python-2.5.tgz}
  \item {\tt cd Python-2.5}
  \item {\tt ./configure} {\it if installing system-wide, or}\newline
        {\tt ./configure --prefix=\$HOME/pyms-deps} {\it if installing locally}
  \item {\tt make}
  \item {\tt make install}
  \end{enumerate}
Please refer to the file {\tt Python-2.5/README} for more details.
\end{description}

\subsection{netCDF}

netCDF (network Common Data Form) is an interface for array-oriented
data access and a library that provides an implementation of the
interface. The netCDF library also defines a machine-independent
format for representing scientific data. Together, the interface,
library, and format support the creation, access, and sharing of
scientific data.

netCDF is available from \url{http://www.unidata.ucar.edu/downloads/netcdf/}.

The description below refers to the installation of netCDF version
3.6.1.

\begin{description}
\item [Filename:] {\tt netcdf-3.6.1.tar.gz}
\item [Installation:] $ $
  \begin{enumerate}
  \item {\tt tar -zxvf netcdf-3.6.1.tar.gz}
  \item {\tt cd netcdf-3.6.1/src}
  \item {\tt ./configure} {\it if installing system-wide, or}\newline
        {\tt ./configure --prefix=\$HOME/pyms-deps} {\it if installing locally}
  \item {\tt make}
  \item {\tt make install}
  \end{enumerate}
Please refer to the file {\tt netcdf-3.6.1/src/INSTALL} for more details.
\end{description}

\subsection{numarray}

numarray is a set of extensions to the Python programming language which
allows large sets of numerical values to be efficiently manipulated.

numarray is available from \url{http://www.stsci.edu/resources/software_hardware/numarray}.

The description below refers to the installation of numarray version
1.5.2.

\begin{description}
\item [Filename:] {\tt numarray-1.5.2.tar.gz}
\item [Installation:] $ $
  \begin{enumerate}
  \item {\tt tar -zxvf numarray-1.5.2.tar.gz}
  \item {\tt cd numarray-1.5.2}
  \item {\tt python setup.py config install --gencode}
  \end{enumerate}
Please refer to the file {\tt numarray-1.5.2/Doc/INSTALL.txt} for more
details.
\end{description}

\subsection{pycdf}

pycdf is a set of extensions to the Python programming language
providing an interface to to the netCDF library. The description
below refers to the installation of pycdf version 0.6-2-rc1.

pycdf is available from \url{http://pysclint.sourceforge.net/pycdf/}.

The description below refers to the installation of pycdf version
0.6-2-rc1.

\begin{description}
\item [Filename:] {\tt pycdf-0.6-2-rc1.tar.gz}
\item [Installation:] $ $
  \begin{enumerate}
  \item {\tt tar -zxvf pycdf-0.6-2-rc1.tar.gz}
  \item {\tt cd pycdf-0.6-2-rc1}
  \item {\tt vi setup.py}
    \begin{enumerate}
    \item At line 31 ({\tt USE = NUMERIC}), add a \# at the start of the line
    \item At line 32 ({\tt \#USE = NUMARRAY}), remove the \# at the start
    of the line
    \item Save the file and exit
    \end{enumerate}
  \item {\tt python setup.py install}
  \end{enumerate}
Please refer to the file {\tt pycdf-0.6-2-rc1/INSTALL} for more details.
\end{description}

\subsection{matplotlib}

matplotlib is a python 2D plotting library.  It is used by pyms for 
visualizations of data.

matplotlib is available from \url{http://matplotlib.sourceforge.net/}.

The description below refers to the installation of matplotlib version
0.87.7.

\begin{description}
\item [Filename:] {\tt matplotlib-0.87.7.tar.gz}
\item [Installation:] $ $
  \begin{enumerate}
  \item Ensure that you have the preequisites for matplotlib's GUI
        extensions, as the plots will not display otherwise. Any one of
        the following can be used:
        \begin{enumerate}
        \item pygtk
        \item wxpython
        \item tk
        \end{enumerate}
  \item {\tt tar -zxvf matplotlib-0.87.7.tar.gz}
  \item {\tt cd matplotlib-0.87.7}
  \item {\tt python setup.py build}
  \item {\tt python setup.py install}
  \end{enumerate}
Please refer to the file {\tt matplotlib-0.87.7/INSTALL} for more
details.
\end{description}

\section{Installing optional dependencies}

Optional dependencies are packages which are not required for the
core functionality of PyMS, but may be required for some extra
functionality, or are highly recommended (such as IPython, interactive
Python shell). 

\subsection{IPython}

IPython is enhanced Python shell suitable for interactive work.

IPython is available from \url{http://ipython.scipy.org/moin/}.

The description below refers to the installation of IPython version
0.7.3.

\begin{description}
\item [Filename:] {\tt ipython-0.7.3.tar.gz}
\item [Installation:] $ $
  \begin{enumerate}
  \item {\tt tar -zxvf ipython-0.7.3.tar.gz}
  \item {\tt cd ipython-0.7.3}
  \item {\tt python setup.py install}
  \end{enumerate}
Please refer to the file {\tt ipython-0.7.3/doc/manual.pdf} for more
details.
\end{description}

\subsection{Numeric}

Numeric is Python module for high-performance numeric computing.
This module is required by Pycluster, and needs to be installed
only if Pycluster is used (see below).

Numeric is available from
\url{http://optusnet.dl.sourceforge.net/sourceforge/numpy/Numeric-24.2.tar.gz}.

The description below refers to the installation of Numeric version
24.2.

\begin{description}
\item [Filename:] {\tt Numeric-24.2.tar.gz}
\item [Installation:] $ $
  \begin{enumerate}
  \item {\tt tar -zxvf Numeric-24.2.tar.gz}
  \item {\tt cd Numeric-24.2}
  \item {\tt python setup.py build}
  \item {\tt python setup.py install}
  \end{enumerate}
Please refer to the file {\tt Numeric-24.2/README} for more
details.
\end{description}

\subsection{Pycluster}

Pycluster is a Python extension module to the clustering routines
in the C Clustering Library by Michiel de Hoon.  Most people will
not use this PyMS, and the installation is highly optional. 

Pycluster is available from
\url{http://bonsai.ims.u-tokyo.ac.jp/~mdehoon/software/cluster/software.htm}.

The description below refers to the installation of Pycluster version
1.33.

\begin{description}
\item [Filename:] {\tt Pycluster-1.33.tar.gz}
\item [Installation:] $ $
  \begin{enumerate}
  \item {\tt tar -zxvf Pycluster-1.33.tar.gz}
  \item {\tt cd Pycluster-1.33}
  \item {\tt python setup.py install}
  \end{enumerate}
\end{description}

\section{PyMS}

\subsection{Downloading PyMS source code}

PyMS source code resides on Google Code servers, and can be accessed
from the following URL: http://code.google.com/p/pyms/. Under the
section "Source" one can find the instructions for downloading the
source code. The same page provides the link under "This project's
Subversion repository can be viewed in your web browser" which allows
one to browse the source code on the server without actually downloading
it.

Google Code servers maintain the source code by the program called
'subversion' (an open-source version control system).  To download the
source code one needs to use the subversion client program called 'svn'.
The 'svn' client exists for all mainstream operating systems\footnote{For
example, on Linux CentOS 4 we have installed the RPM package
'subversion-1.3.2-1.rhel4.i386.rpm' to provide us with the subversion
client 'svn'.}, for more information see http://subversion.tigris.org/.
The book about subversion is freely available on-line at
http://svnbook.red-bean.com/. Subversion has extensive functionality
however only the very basic functionality is needed to download PyMS
source code.

If the computer is connected to the internet and the subversion client
is installed, the following command will download the latest PyMS 
source code in the current directory:

\begin{verbatim}
$ svn checkout http://pyms.googlecode.com/svn/trunk/ pyms
A    pyms/Peak
A    pyms/Peak/__init__.py
A    pyms/Peak/List
A    pyms/Peak/List/__init__.py
.....
A    pyms/Noise/Window.py
Checked out revision 30.
$ ls -CF
pyms/
$
\end{verbatim}

\subsection{PyMS installation}

The process described above shows the installation of netCDF, numarray,
and pycdf within the Python standard distribution. This is typically
a directory named "site-packages" withini the Python installation
directory (for example, /usr/local/lib/python2.4). For example, if
"pycdf" and "numarray" are installed listing files in this directory
would show:

\begin{verbatim}
$ ls -CF /usr/local/lib/python2.4/site-packages
pycdf/ numarray/
$ 
\end{verbatim}

To install PyMS one needs to copy PyMS source directory to
the site-packages directory:

\begin{verbatim}
$ cp -r pyms /usr/local/lib/python2.4/site-packages
\end{verbatim}

The easiest way to test if PyMS has been installed properly is 
to attempt to import the package within the Python environment:

\begin{verbatim}
$ python
Python 2.4.1 (#1, Jun 27 2005, 12:53:02) 
[GCC 3.4.3 20041212 (Red Hat 3.4.3-9.EL4)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import pyms
>>>
\end{verbatim}

It there are no feedback messaged to the import command, Python
was able to load PyMS. 

\subsection{Installing PyMS elsewhere}

Installing PyMS in the python standard directory may require
super-user password. The alternative installation is to install
PyMS somewhere locally. For example, the directory pyms/ with
PyMS source code could be placed in the directory /home/projects/.
To make Python aware of PyMS the following commands are required
before any part of PyMS is called:

\begin{verbatim}
import sys
sys.path.append("/home/projects")
\end{verbatim}

Alternatively the environment variable PYTHONPATH could be set
to "/home/projects/". For example, under the bash shell: 

\begin{verbatim}
$ PYTHONPATH=/home/projects/; export PYTHONPATH
\end{verbatim}

More information about sys.path.append() and PYTHONPATH is possible
to find in Python documentation.

\section{IPython}

IPython is a substitute for the stock Python interactive shell. It
provides several features which enhances the day-to-day workflow of
using PyMS, but is not required for its operation.

Its improvements include:
\begin{enumerate}
    \item {\bf Tab completion:} Press the {\tt TAB key} to autocomplete
          variable and function names, and directory entries.
    \item {\bf Object inspection:} Type {\tt \$objectname} to obtain
          information and documentation about it.
    \item {\bf Shell passthrough:} Type {\tt !commandname} to execute a
          shell command. The output of the command can be assigned to a
          variable if necessary.
    \item {\bf Color highlighting:} Input and output are highlighted in
          different colors for easier distinguishing.
    \item {\bf Command history:} Press {\tt UP} or {\tt DOWN} to scroll through the
          command history, and {\tt CTRL-R} to search through the history. The
          history is persistent across sessions.
    \item {\bf Logging:} Input can be logged to a file, allowing for
          future inspection or replay. Type {\tt \%logstart logname}
          in IPython to activate logging.
\end{enumerate}

IPython can be obtained from \url{http://ipython.scipy.org/dist/}. The
description below refers to the installation of IPython version 0.7.2.

\begin{description}
\item [Filename:] {\tt ipython-0.7.2.tar.gz} (or newer)
\item [Installation:] $ $
  \begin{enumerate}
  \item {\tt tar -zxvf ipython-0.7.2.tar.gz}
  \item {\tt cd ipython-0.7.2}
  \item {\tt python setup.py build}
  \item {\tt python setup.py install}
  \end{enumerate}
\end{description}
