% chapter01.tex

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                           %
 %    PyMS documentation                                                     %
 %    Copyright (C) 2005-8 Vladimir Likic                                    %
 %                                                                           %
 %    The files in this directory provided under the Creative Commons        %
 %    Attribution-NonCommercial-NoDerivs 2.1 Australia license               %
 %    http://creativecommons.org/licenses/by-nc-nd/2.1/au/                   %
 %    See the file license.txt                                               %
 %                                                                           %
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Using PyMS}

\section{About PyMS}

PyMS is a Python toolkit for processing of chromatography--mass spectrometry
data. The idea behind PyMS is to decouple processing methods form visualization
and the concept of interactive processing, and to provdie a set of components
useful for experimentation and the development of new methods for processing
of chromatography--mass spectrometry data. Current PyMS development is
strongly influenced by the needs in processing of gas chromatography-mass
spectrometry (GC-MS) data.

PyMS is highly modular and consists of several sub-packages written in Python
programming language \cite{python}.  PyMS is released as open source, under
the GNU Public License version 2.

\section{Reading GC-MS data}

\subsection{ANDI-MS data format}

Unfortunately, the field of chromatography--mass spectrometry is ruled
by proprietary, closed data formats.  Anything that comes even closse
to an open standard is the incomplete and now obsolete ANDI-MS data
format.

ANDI-MS data format stands for Analytical Data Interchange for Mass
Spectrometry, and was developed for the description of mass spectrometric
data developed in 1994 by Analytical Instrument Association. ANDI-MS 
is essentially a recommendation, and it is up to individual vendors of
mass spectrometry processing software to implement "export to ANDI-MS"
feature in their software. Furthermore, it is vendor's good will to
implement ANDI-MS specifications properly. Because of these limitations
it is difficult to be certain that one can properly read ANDI-MS files
from a particular vendor without testing this first.

\subsection{Reading the data in PyMS}

The PyMS package pyms.IO provides capabilities to read the raw GC-MS
data stored in the ANDI-MS format. The function IO.ANDI.ChemStation()
provides the interface to ANDI-MS data files saved from Agilent
ChemStation software. The name is a reminder that this function has
been reasonably tested only on the data exported from Agilent ChemStation.

In an interactive session from Python, the ANDI-MS file can be loaded
in the memory as follows:

\begin{verbatim}
>>> from pyms import IO
>>> data = IO.ANDI.Class.ChemStation('0510_217.CDF')
 -> Processing netCDF file '0510_217.CDF'
    [ 2784 scans, masses from 50 to 550 ]
>>>
\end{verbatim}

Where '0510\_217.CDF' is the name of the GC-MS data saved in the ANDI-MS
format from the Agilent ChemStation software.  The above command creates
the object 'data' which is an {\em instance} of the class IO.ANDI.ChemStation.
The instance 'data' has several attributes and methods associated with it:

\begin{itemize}

\item {\tt get\_filename()} -- Returns the name of the file from which
the data was loaded. Usage example:

\begin{verbatim}
>>> data.get_filename()
'0510_217.CDF'
\end{verbatim}

\item {\tt get\_ic\_at\_index(i)} -- Returns an IonChromatogram object
at index i.  For example, to get the first ion chromatogram from the data
matrix:

\begin{verbatim}
>>> ic = data.get_ic_at_index(1)
\end{verbatim}

\noindent
An IonChromatogram object is the one dimensional time vector containing
mass intensities.  One often deals with two types of IonChromatogram
objects: ion chromatograms at particular m/z value (for example, ion
chromatograms at m/z = 65), or total ion chromatograms (TICs), which
contain the sum of intensities for all masses at any given time point. 
The nature of an IonChromatogram object can be revealed by the content
of the attribute '\_mass', which is set to None if the ion chromatogram
is TIC; otherwise it contains the m/z value of the ion chromatogram.
Continuing the previous example:

\begin{verbatim}
>>> ic._mass
51
\end{verbatim}

\noindent
This shows that the first ion chromatogram in the data file is for
m/z = 51.

\item {\tt get\_ic\_at\_mass(mz)} -- Returns an IonChromatogram
object corresponding to given m/z. For example, to get the ion
chromatogram that corresponds to m/z = 73:

\begin{verbatim}
>>> ic = data.get_ic_at_mass(73)
>>> ic._mass
73
\end{verbatim}

\item {\tt get\_intensity\_matrix()} -- Returns the entire data
matrix, i.e. time vs m/z as numarray object. Usage example:

\begin{verbatim}
>>> im = data.get_intensity_matrix()
>>> len(im)
2784
>>> len(im[0])
501
\end{verbatim}

This data matrix contains 2784 time points (MS scans) and each time
point corresponds to a mass spectrum of 501 m/z points.

\end{itemize}


